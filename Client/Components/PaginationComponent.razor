@if (ElementsSize != 0) { 
    <nav aria-label="Pagination" class="pagination-element">
        <ul class="pagination">
            @if (ActualPage == 0)
            {
                <li class="page-item disabled">
                    <a class="page-link" aria-label="Previous" @onclick="PrevPage">
                        <span aria-hidden="true">&laquo;</span>
                        <span class="sr-only">Previous</span>
                    </a>
                </li>
            }
            else
            {
                <li class="page-item">
                    <a class="page-link" aria-label="Previous" @onclick="PrevPage">
                        <span aria-hidden="true">&laquo;</span>
                        <span class="sr-only">Previous</span>
                    </a>
                </li>
            }
            @if (MaxPage < MaxComponents) //przypadek 1 2 3 4 5 6
            {
                @for (int i = 0; i < MaxPage; i++)
                {
                    var temp = i;
                    if (i == ActualPage)
                    {
                        <li class="page-item active"><a class="page-link" @onclick="(() => ChangePage(temp))">@(i + 1)</a></li>
                    }
                    else
                    {
                        <li class="page-item"><a class="page-link" @onclick="(() => ChangePage(temp))">@(i + 1)</a></li>
                    }

                }

            }
            else //przypadek 1..25
            {
                if (ActualPage - 1 < 4) //przypadek | 1 2 3 4 5 6| ... 25
                {
                    @for (int i = 0; i < MaxComponents; i++)
                    {
                        var temp = i;
                        if (i == ActualPage)
                        {
                            <li class="page-item active"><a class="page-link">@(i + 1)</a></li>
                        }
                        else
                        {
                            <li class="page-item"><a class="page-link" @onclick="(() => ChangePage(temp))">@(i + 1)</a></li>
                        }
                    }
                    <li class="page-item disabled"><a class="page-link">...</a></li>
                    <li class="page-item"><a class="page-link" @onclick="(() => ChangePage(MaxPage-1))">@MaxPage</a></li>
                }
                else if (MaxPage - ActualPage < 4) //przypadek 1 ... |20 21 22 23 24 25|
                {
                    <li class="page-item"><a class="page-link" @onclick="(() => PageSelectedListener.InvokeAsync(0))">1</a></li>
                    <li class="page-item disabled"><a class="page-link">...</a></li>
                    for (int i = MaxPage - MaxComponents; i < MaxPage; i++)
                    {
                        var temp = i;
                        if (i == ActualPage)
                        {
                            <li class="page-item active"><a class="page-link" @onclick="(() => ChangePage(temp))">@(i + 1)</a></li>
                        }
                        else
                        {
                            <li class="page-item"><a class="page-link" @onclick="(() => ChangePage(temp))">@(i + 1)</a></li>
                        }
                    }
                }
                else //przypadek 1... |5 6 7 8 9 10| ... 25
                {
                    <li class="page-item"><a class="page-link" @onclick="(() => ChangePage(0))">1</a></li>
                    <li class="page-item disabled"><a class="page-link">...</a></li>
                    @for (int i = ActualPage - (MaxComponents / 2); i < ActualPage + (MaxComponents / 2); i++)
                    {
                        var temp = i;
                        if (i == ActualPage)
                        {
                            <li class="page-item active"><a class="page-link" @onclick="(() => ChangePage(temp))">@(i + 1)</a></li>
                        }
                        else
                        {
                            <li class="page-item"><a class="page-link" @onclick="(() => ChangePage(temp))">@(i + 1)</a></li>
                        }
                    }
                    <li class="page-item disabled"><a class="page-link">...</a></li>
                    <li class="page-item"><a class="page-link" @onclick="(() => ChangePage(MaxPage-1))">@MaxPage</a></li>
                }
            }

            @if (ActualPage+1 == MaxPage)
            {
                <li class="page-item disabled">
                    <a class="page-link" aria-label="Next" @onclick="NextPage">
                        <span aria-hidden="true">&raquo;</span>
                        <span class="sr-only">Next</span>
                    </a>
                </li>
            }
            else
            {
                <li class="page-item">
                    <a class="page-link" aria-label="Next" @onclick="NextPage">
                        <span aria-hidden="true">&raquo;</span>
                        <span class="sr-only">Next</span>
                    </a>
                </li>
            }
        </ul>
    </nav>
}

@code {
    [Parameter]
    public int ElementsSize { get; set; }
    [Parameter]
    public int PageSize { get; set; }
    [Parameter]
    public EventCallback<int> PageSelectedListener { get; set; }
    [Parameter]
    public int ActualPage { get; set; }

    int MaxPage;

    private readonly int MaxComponents = 6;

    protected async override Task OnParametersSetAsync()
    {
        if (ElementsSize % PageSize == 0)
            MaxPage = ElementsSize / PageSize;
        else
            MaxPage = ElementsSize / PageSize + 1;
    }

    private async Task PrevPage()
    {
        if (ActualPage != 0)
        {
            ActualPage--;
            await PageSelectedListener.InvokeAsync(ActualPage);
        }
    }
    private async Task NextPage()
    {
        if (ActualPage != MaxPage)
        {
            ActualPage++;
            await PageSelectedListener.InvokeAsync(ActualPage);
        }
    }

    private async Task ChangePage(int i)
    {
        ActualPage = i;
        await PageSelectedListener.InvokeAsync(ActualPage);
        StateHasChanged();
    }
}

